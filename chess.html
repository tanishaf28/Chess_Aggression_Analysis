<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚ôüÔ∏è Does Aggression Win?  A Chess Data Story</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cinzel:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<style>
  :root {
    --gold: #D4A843;
    --gold-light: #F0C85A;
    --gold-dark: #8B6914;
    --cream: #F5F0E8;
    --dark: #0A0A0A;
    --dark2: #111111;
    --dark3: #1A1A1A;
    --red: #C0392B;
    --teal: #2E8B7A;
    --board-light: #F0D9B5;
    --board-dark: #B58863;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background-color: var(--dark);
    color: rgba(245,240,232,0.95);
    font-family: 'EB Garamond', serif;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    text-shadow: 0 1px 0 rgba(0,0,0,0.35);
  }

  /* ===== CHESS BOARD BACKGROUND ===== */
  .chess-bg {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 0;
    opacity: 0.06;
    display: grid;
    grid-template-columns: repeat(8, 12.5%);
    grid-template-rows: repeat(8, 12.5%);
    pointer-events: none;
  }
  .chess-bg .sq { }
  .chess-bg .sq.light { background: #ffffff; }
  .chess-bg .sq.dark { background: #000000; }

  .overlay {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: radial-gradient(ellipse at 50% 0%, rgba(212,168,67,0.08) 0%, transparent 60%),
                radial-gradient(ellipse at 0% 100%, rgba(192,57,43,0.06) 0%, transparent 50%),
                radial-gradient(ellipse at 100% 50%, rgba(46,139,122,0.06) 0%, transparent 50%);
    z-index: 0;
    pointer-events: none;
  }

  .content { position: relative; z-index: 1; }

  /* ===== HERO ===== */
  .hero {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 60px 20px;
    position: relative;
  }

  .hero::before {
    content: '';
    position: absolute;
    inset: 0;
    background: 
      radial-gradient(ellipse 80% 60% at 50% 50%, rgba(212,168,67,0.12) 0%, transparent 70%);
  }

  .piece-float {
    font-size: clamp(80px, 15vw, 180px);
    line-height: 1;
    animation: float 6s ease-in-out infinite;
    filter: drop-shadow(0 0 40px rgba(212,168,67,0.4));
    margin-bottom: 20px;
    position: relative;
    z-index: 1;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0) rotate(-3deg); }
    50% { transform: translateY(-20px) rotate(3deg); }
  }

  .hero-eyebrow {
    font-family: 'Cinzel', serif;
    font-size: clamp(11px, 1.5vw, 14px);
    letter-spacing: 0.5em;
    color: var(--gold);
    text-transform: uppercase;
    margin-bottom: 20px;
    opacity: 0;
    animation: fadeUp 1s 0.3s forwards;
    position: relative; z-index: 1;
  }

  .hero-title {
    font-family: 'Cinzel Decorative', serif;
    font-size: clamp(28px, 6vw, 80px);
    font-weight: 900;
    line-height: 1.1;
    background: linear-gradient(135deg, var(--gold-light) 0%, var(--gold) 40%, var(--gold-dark) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 24px;
    opacity: 0;
    animation: fadeUp 1s 0.5s forwards;
    position: relative; z-index: 1;
    text-shadow: none;
  }

  .hero-subtitle {
    font-family: 'EB Garamond', serif;
    font-size: clamp(16px, 2.5vw, 24px);
    font-style: italic;
    color: rgba(245,240,232,0.7);
    max-width: 700px;
    line-height: 1.7;
    margin-bottom: 40px;
    opacity: 0;
    animation: fadeUp 1s 0.7s forwards;
    position: relative; z-index: 1;
  }

  .hero-stats {
    display: flex;
    gap: 40px;
    flex-wrap: wrap;
    justify-content: center;
    opacity: 0;
    animation: fadeUp 1s 0.9s forwards;
    position: relative; z-index: 1;
  }

  .hero-stat {
    text-align: center;
    border: 1px solid rgba(212,168,67,0.3);
    padding: 16px 28px;
    background: rgba(212,168,67,0.05);
    backdrop-filter: blur(10px);
  }

  .hero-stat .num {
    font-family: 'Cinzel', serif;
    font-size: 32px;
    font-weight: 700;
    color: var(--gold);
  }
  .hero-stat .label {
    font-size: 13px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: rgba(245,240,232,0.5);
    margin-top: 4px;
  }

  .scroll-hint {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    animation: bounce 2s infinite;
    opacity: 0.5;
    z-index: 1;
  }
  .scroll-hint span { font-size: 11px; letter-spacing: 0.3em; text-transform: uppercase; }
  @keyframes bounce {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(8px); }
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* ===== CHAPTER DIVIDERS ===== */
  .chapter {
    padding: 100px 20px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .chapter-intro {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 60px;
    align-items: center;
    margin-bottom: 60px;
  }

  @media (max-width: 768px) {
    .chapter-intro { grid-template-columns: 1fr; }
  }

  .chapter-num {
    font-family: 'Cinzel Decorative', serif;
    font-size: clamp(80px, 12vw, 140px);
    font-weight: 900;
    color: rgba(212,168,67,0.16);
    line-height: 0.9;
    user-select: none;
    text-shadow: 0 2px 6px rgba(0,0,0,0.6);
  }

  /* fixed section counter (top-right) */
  #sectionCounter {
    position: fixed;
    top: 16px;
    right: 18px;
    z-index: 9999;
    background: linear-gradient(180deg, rgba(20,20,20,0.96), rgba(10,10,10,0.92));
    color: var(--gold);
    border: 1px solid rgba(212,168,67,0.18);
    padding: 12px 16px;
    border-radius: 10px;
    font-family: 'Cinzel', serif;
    font-weight: 700;
    font-size: 13px;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    box-shadow: 0 8px 26px rgba(0,0,0,0.55);
    opacity: 0.94;
    transform: translateY(0);
    transition: box-shadow 180ms ease, transform 180ms ease;
    pointer-events: auto;
    cursor: pointer;
  }
  #sectionCounter.visible { box-shadow: 0 12px 36px rgba(0,0,0,0.6); transform: translateY(-4px); }

  /* floating pieces */
  .floating-pieces {
    position: fixed;
    left: 12px;
    top: 18px;
    z-index: 9000;
    display: flex;
    gap: 8px;
    opacity: 0.12;
    font-size: 20px;
    pointer-events: none;
  }
  .floating-pieces span { display: inline-block; transform-origin: center; color: rgba(212,168,67,0.9); filter: drop-shadow(0 2px 6px rgba(0,0,0,0.6)); }
  .floating-pieces span:nth-child(1){ animation: floatTiny 4s ease-in-out infinite; }
  .floating-pieces span:nth-child(2){ animation: floatTiny 5s ease-in-out infinite .3s; }
  .floating-pieces span:nth-child(3){ animation: floatTiny 4.6s ease-in-out infinite .6s; }
  .floating-pieces span:nth-child(4){ animation: floatTiny 5.2s ease-in-out infinite .9s; }
  .floating-pieces span:nth-child(5){ animation: floatTiny 4.4s ease-in-out infinite 1.1s; }
  @keyframes floatTiny { 0%{ transform: translateY(0) rotate(-4deg); }50%{ transform: translateY(-8px) rotate(4deg); }100%{ transform: translateY(0) rotate(-4deg); } }

  .chapter-label {
    font-family: 'Cinzel', serif;
    font-size: 11px;
    letter-spacing: 0.5em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 16px;
  }

  .chapter-title {
    font-family: 'Cinzel Decorative', serif;
    font-size: clamp(20px, 3.5vw, 38px);
    font-weight: 700;
    line-height: 1.3;
    color: var(--cream);
    margin-bottom: 20px;
  }

  .chapter-body {
    font-size: clamp(16px, 1.8vw, 19px);
    line-height: 1.85;
    color: rgba(245,240,232,0.75);
  }

  .chapter-body em {
    color: var(--gold-light);
    font-style: italic;
  }

  /* ===== DIVIDER ===== */
  .divider {
    display: flex;
    align-items: center;
    gap: 20px;
    margin: 60px 0;
  }
  .divider::before, .divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(212,168,67,0.4), transparent);
  }
  .divider-piece { font-size: 24px; }

  /* ===== FULL-WIDTH SECTION BREAKS ===== */
  .section-break {
    width: 100%;
    padding: 60px 20px;
    background: linear-gradient(180deg, transparent, rgba(212,168,67,0.04), transparent);
    border-top: 1px solid rgba(212,168,67,0.1);
    border-bottom: 1px solid rgba(212,168,67,0.1);
    text-align: center;
    margin: 40px 0;
  }

  .section-break .big-quote {
    font-family: 'Cinzel Decorative', serif;
    font-size: clamp(18px, 3vw, 36px);
    font-weight: 700;
    background: linear-gradient(135deg, var(--gold-light), var(--gold));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    max-width: 900px;
    margin: 0 auto;
    line-height: 1.4;
  }

  /* ===== CHARTS ===== */
  .chart-container {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(212,168,67,0.15);
    padding: 30px;
    margin: 30px 0;
    position: relative;
  }

  .chart-container::before {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 40px; height: 40px;
    border-top: 2px solid var(--gold);
    border-left: 2px solid var(--gold);
  }
  .chart-container::after {
    content: '';
    position: absolute;
    bottom: 0; right: 0;
    width: 40px; height: 40px;
    border-bottom: 2px solid var(--gold);
    border-right: 2px solid var(--gold);
  }

  .chart-title {
    font-family: 'Cinzel', serif;
    font-size: clamp(13px, 1.8vw, 17px);
    font-weight: 600;
    color: var(--gold-light);
    margin-bottom: 8px;
    letter-spacing: 0.05em;
  }

  .chart-subtitle {
    font-size: 14px;
    color: rgba(245,240,232,0.45);
    margin-bottom: 24px;
    font-style: italic;
  }

  canvas { max-width: 100%; }

  /* ===== FINDING CARDS ===== */
  .finding {
    background: linear-gradient(135deg, rgba(212,168,67,0.08), rgba(212,168,67,0.02));
    border-left: 3px solid var(--gold);
    padding: 24px 28px;
    margin: 24px 0;
    position: relative;
  }

  .finding::before {
    display: none;
  }

  .finding-title {
    font-family: 'Cinzel', serif;
    font-size: 13px;
    letter-spacing: 0.3em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 10px;
  }

  .finding-text {
    font-size: clamp(15px, 1.6vw, 18px);
    line-height: 1.8;
    color: rgba(245,240,232,0.85);
  }

  .finding-text strong {
    color: var(--gold-light);
    font-weight: 600;
  }

  /* ===== STAT PILLS ===== */
  .stat-row {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    margin: 24px 0;
  }

  .stat-pill {
    background: rgba(212,168,67,0.08);
    border: 1px solid rgba(212,168,67,0.25);
    padding: 12px 20px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
    min-width: 140px;
  }

  .stat-pill .val {
    font-family: 'Cinzel', serif;
    font-size: 26px;
    font-weight: 700;
    color: var(--gold-light);
  }

  .stat-pill .desc {
    font-size: 12px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: rgba(245,240,232,0.45);
  }

  /* ===== TWO COL ===== */
  .two-col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
    margin: 24px 0;
  }

  @media (max-width: 768px) {
    .two-col { grid-template-columns: 1fr; }
  }

  /* ===== CONCLUSION ===== */
  .conclusion {
    padding: 120px 20px;
    text-align: center;
    position: relative;
  }

  .conclusion::before {
    content: '';
    position: absolute;
    top: 0; left: 50%; transform: translateX(-50%);
    width: 1px; height: 80px;
    background: linear-gradient(to bottom, transparent, var(--gold));
  }

  .verdict-box {
    max-width: 820px;
    margin: 60px auto;
    padding: 44px 48px;
    border-radius: 12px;
    border: 1px solid rgba(212,168,67,0.25);
    background: linear-gradient(180deg, rgba(212,168,67,0.04), rgba(212,168,67,0.02));
    position: relative;
    box-shadow: 0 10px 40px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.02);
  }

  /* new verdict presentation */
  .verdict-panel {
    display: grid;
    grid-template-columns: 220px 1fr;
    gap: 28px;
    align-items: center;
  }
  .verdict-badge {
    background: linear-gradient(180deg, rgba(212,168,67,0.12), rgba(212,168,67,0.04));
    border: 1px solid rgba(212,168,67,0.12);
    padding: 18px;
    border-radius: 12px;
    text-align: center;
  }
  .verdict-badge .badge-icon { font-size: 48px; color: var(--gold); margin-bottom: 6px; }
  .verdict-badge .badge-text { font-family: 'Cinzel', serif; font-weight:700; color: var(--gold); letter-spacing: 0.12em; text-transform: uppercase; }
  .verdict-badge .badge-sub { margin-top: 8px; font-size: 13px; color: rgba(245,240,232,0.9); }

  .verdict-body { color: rgba(245,240,232,0.95); }
  .verdict-summary { font-size: 18px; line-height: 1.6; margin-bottom: 14px; }
  .verdict-chips { display:flex; gap:10px; flex-wrap:wrap; margin-bottom: 12px; }
  .verdict-chip { background: rgba(255,255,255,0.03); border:1px solid rgba(212,168,67,0.09); padding:8px 12px; border-radius:999px; color:var(--gold); font-weight:700; font-family:'Cinzel',serif; font-size:13px; }

  .verdict-more { max-height: 0; overflow: hidden; transition: max-height 350ms ease; }
  .verdict-more.open { max-height: 400px; }
  .verdict-toggle { margin-top: 12px; background: transparent; border: 1px solid rgba(255,255,255,0.06); color: rgba(245,240,232,0.95); padding:8px 12px; border-radius:8px; cursor:pointer; }

  /* confetti canvas */
  #verdictConfetti { position:absolute; inset:0; pointer-events:none; border-radius:12px; }

  .verdict-box::before, .verdict-box::after {
    content: '‚ôõ';
    position: absolute;
    font-size: 30px;
    color: var(--gold);
    opacity: 0.5;
  }
  .verdict-box::before { top: 16px; left: 20px; }
  .verdict-box::after { bottom: 16px; right: 20px; }

  .verdict-title {
    font-family: 'Cinzel Decorative', serif;
    font-size: clamp(14px, 2.5vw, 22px);
    font-weight: 700;
    color: var(--gold);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 20px;
  }

  .verdict-text {
    font-size: clamp(16px, 2vw, 21px);
    line-height: 1.9;
    font-style: italic;
    color: rgba(245,240,232,0.95);
    text-align: left;
    font-family: 'EB Garamond', serif;
  }

  .verdict-text strong {
    color: var(--gold-light);
    font-style: normal;
  }

  /* ===== PROGRESS BARS ===== */
  .progress-bar-container {
    margin: 12px 0;
  }

  .progress-label {
    display: flex;
    justify-content: space-between;
    margin-bottom: 6px;
    font-size: 14px;
    color: rgba(245,240,232,0.7);
  }
  .progress-label .pval {
    font-family: 'Cinzel', serif;
    color: var(--gold);
    font-weight: 600;
  }

  .progress-track {
    height: 8px;
    background: rgba(255,255,255,0.06);
    position: relative;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--gold-dark), var(--gold-light));
    transition: width 2s ease;
    width: 0%;
  }

  .progress-fill.animated { }

  /* ===== CHESS PIECES ACCENT ===== */
  .piece-row {
    display: flex;
    justify-content: center;
    gap: 8px;
    font-size: 24px;
    opacity: 0.3;
    margin: 40px 0;
  }

  /* ===== BOARD VIZ ===== */
  .board-mini {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    width: 200px;
    height: 200px;
    border: 2px solid rgba(212,168,67,0.4);
  }

  .board-mini .bsq { }
  .board-mini .bsq.l { background: rgba(240,217,181,0.15); }
  .board-mini .bsq.d { background: rgba(181,136,99,0.15); }

  /* ===== ANNOTATIONS ===== */
  .annotation {
    display: flex;
    gap: 16px;
    align-items: flex-start;
    padding: 20px;
    background: rgba(255,255,255,0.02);
    margin: 12px 0;
    border: 1px solid rgba(255,255,255,0.06);
  }

  .annotation .icon { font-size: 28px; flex-shrink: 0; }
  .annotation-text { font-size: 15px; line-height: 1.7; color: rgba(245,240,232,0.75); }
  .annotation-text strong { color: var(--cream); }

  /* ===== FOOTER ===== */
  footer {
    padding: 60px 20px;
    text-align: center;
    border-top: 1px solid rgba(212,168,67,0.15);
    color: rgba(245,240,232,0.3);
    font-size: 14px;
    letter-spacing: 0.1em;
  }

  footer .gold { color: var(--gold); }

  /* ===== REVEAL ANIMATIONS ===== */
  .reveal {
    opacity: 0;
    transform: translateY(40px);
    transition: opacity 0.8s ease, transform 0.8s ease;
  }
  .reveal.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* table styles */
  .data-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 15px;
  }
  .data-table th {
    font-family: 'Cinzel', serif;
    font-size: 11px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--gold);
    padding: 12px 16px;
    border-bottom: 1px solid rgba(212,168,67,0.3);
    text-align: left;
  }
  .data-table td {
    padding: 11px 16px;
    border-bottom: 1px solid rgba(255,255,255,0.04);
    color: rgba(245,240,232,0.8);
  }
  .data-table tr:hover td { background: rgba(212,168,67,0.04); }

  .highlight-row td { color: var(--gold-light); font-weight: 500; }

  .tag {
    display: inline-block;
    padding: 3px 10px;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    border: 1px solid;
  }
  .tag.red { border-color: var(--red); color: var(--red); }
  .tag.teal { border-color: var(--teal); color: #4ECDC4; }
  .tag.gold { border-color: var(--gold); color: var(--gold); }

  /* highlighted numbers */
  .num-highlight {
    color: var(--gold-light);
    font-weight: 700;
    background: rgba(212,168,67,0.06);
    padding: 0 4px;
    border-radius: 4px;
    display: inline-block;
    line-height: 1;
  }

  /* chapter navigator dropdown */
  .chapter-nav {
    position: fixed;
    top: 56px;
    right: 18px;
    z-index: 10000;
    background: linear-gradient(180deg, rgba(12,12,12,0.98), rgba(18,18,18,0.95));
    color: rgba(245,240,232,0.95);
    border: 1px solid rgba(212,168,67,0.14);
    padding: 8px;
    border-radius: 8px;
    min-width: 260px;
    max-height: 60vh;
    overflow: auto;
    box-shadow: 0 18px 50px rgba(0,0,0,0.6);
    opacity: 0;
    transform: translateY(-6px);
    transition: opacity 180ms ease, transform 180ms ease;
    pointer-events: none;
  }
  .chapter-nav.visible { opacity: 1; transform: translateY(0); pointer-events: auto; }
  .chapter-nav button {
    width: 100%;
    text-align: left;
    padding: 10px 12px;
    border: none;
    background: transparent;
    color: inherit;
    cursor: pointer;
    font-family: 'EB Garamond', serif;
    font-size: 14px;
    border-radius: 6px;
  }
  .chapter-nav button:hover { background: rgba(255,255,255,0.03); }
  .chapter-nav .chap-num { color: var(--gold); font-weight:700; margin-right:8px; }
</style>
</head>
<body>

<!-- Chess board background -->
<div class="chess-bg" id="chessBg"></div>
<div class="overlay"></div>

<div id="sectionCounter" aria-hidden="false" title="Click to jump to this section"></div>

<!-- subtle floating pieces for visual effect -->
<div class="floating-pieces" aria-hidden="true">
  <span>‚ôü</span><span>‚ôû</span><span>‚ôú</span><span>‚ôù</span><span>‚ôõ</span>
</div>

<!-- chapter navigator (populated by JS) -->
<div id="chapterNav" class="chapter-nav" aria-hidden="true"></div>

<div class="content">

<!-- ===== HERO ===== -->
<section class="hero">
  <div class="piece-float">‚ôü</div>
  <div class="hero-eyebrow">A Data Science Story ¬∑ 20,058 Games Analyzed</div>
  <h1 class="hero-title">Does Aggression<br>Win at Chess?</h1>
  <p class="hero-subtitle">We dove into over twenty thousand chess games to answer one of the game's oldest debates: Do gambits and attacks triumph, or does patient, positional play reign supreme?</p>
  <div class="hero-stats">
    <div class="hero-stat"><div class="num">20,058</div><div class="label">Games Analyzed</div></div>
    <div class="hero-stat"><div class="num">49.86%</div><div class="label">White Win Rate</div></div>
    <div class="hero-stat"><div class="num">45.40%</div><div class="label">Black Win Rate</div></div>
    <div class="hero-stat"><div class="num">4.74%</div><div class="label">Draw Rate</div></div>
  </div>
  <div class="scroll-hint">
    <span>Scroll to discover</span>
    <div style="font-size: 18px;">‚Üì</div>
  </div>
</section>

<!-- ===== CH 1: THE BATTLEFIELD ===== -->
<section class="chapter">
  <div class="chapter-intro reveal">
    <div>
      <div class="chapter-num">I</div>
    </div>
    <div>
      <div class="chapter-label">Chapter One</div>
      <h2 class="chapter-title">Setting the Board</h2>
      <p class="chapter-body">
        Every chess game begins with a choice: <em>how will you fight?</em> Will you hurl your pawns forward recklessly, sacrificing material for chaos? Or will you build slowly, inch by inch, constructing an unbreakable fortress?
        <br><br>
        We classified 20,058 games by opening style <em>Very Aggressive</em> (gambits & attacks), <em>Aggressive</em> (Sicilian, Dutch, King's Indian), <em>Positional</em> (London, Queen's Gambit, French), and <em>Balanced</em> and followed each game to its conclusion.
      </p>
    </div>
  </div>

  <!-- Opening distribution chart -->
  <div class="chart-container reveal">
    <div class="chart-title">Opening Style Distribution Across 20,058 Games</div>
    <div class="chart-subtitle">How do players actually choose to open? The answer reveals a lot about human psychology at the board.</div>
    <canvas id="openingDistChart" height="90"></canvas>
  </div>

  <div class="finding reveal">
    <div class="finding-title">Key Finding</div>
    <div class="finding-text">
      <strong>Positional play dominates.</strong> 44% of all games opened with positional systems nearly double the rate of any aggressive alternative. Very aggressive openings (gambits, attacks) accounted for 25.6%, while balanced and purely aggressive styles split the rest. The average chess player, it seems, prefers to build rather than brawl ‚Äî at least when picking their opening moves.
    </div>
  </div>

  <div class="piece-row">‚ôö ‚ôõ ‚ôú ‚ôù ‚ôû ‚ôü ‚ôü ‚ôû ‚ôù ‚ôú ‚ôõ ‚ôö</div>
</section>

<!-- ===== SECTION BREAK ===== -->
<div class="section-break">
  <div class="big-quote">"In chess, style matters but how much does it <em>actually</em> affect who wins?"</div>
</div>

<!-- ===== CH 2: THE FIRST REVEAL ===== -->
<section class="chapter">
  <div class="chapter-intro reveal">
    <div>
      <div class="chapter-num">II</div>
    </div>
    <div>
      <div class="chapter-label">Chapter Two</div>
      <h2 class="chapter-title">The First Reveal: Positional Wins More</h2>
      <p class="chapter-body">
        The data delivers its first surprise. When we tallied win rates by opening style, positional play led the pack but only by a hair. The differences are real, yet remarkably modest. Chess is far more nuanced than a simple "aggression = wins" equation.
      </p>
    </div>
  </div>

  <div class="two-col reveal">
    <div class="chart-container">
      <div class="chart-title">White Win Rate by Opening Style</div>
      <div class="chart-subtitle">Positional openings edge out the rest</div>
      <canvas id="winRateByStyle" height="200"></canvas>
    </div>
    <div>
      <div class="stat-row">
        <div class="stat-pill"><div class="val">51.6%</div><div class="desc">Positional Win Rate</div></div>
        <div class="stat-pill"><div class="val">50.7%</div><div class="desc">Very Aggressive Win Rate</div></div>
      </div>
      <div class="stat-row">
        <div class="stat-pill"><div class="val">47.2%</div><div class="desc">Aggressive Win Rate</div></div>
        <div class="stat-pill"><div class="val">46.0%</div><div class="desc">Balanced Win Rate</div></div>
      </div>

      <div class="finding" style="margin-top: 20px;">
        <div class="finding-title">Insight</div>
        <div class="finding-text">
          The gap between best and worst? Just <strong>5.6 percentage points</strong>. Positional beats Very Aggressive by ~1%. This is the first clue that opening style is not the primary driver of who wins chess games.
        </div>
      </div>

      <table class="data-table">
        <tr><th>Style</th><th>White Win</th><th>Black Win</th><th>Draw</th></tr>
        <tr class="highlight-row"><td>Positional</td><td>51.6%</td><td>43.7%</td><td>4.7%</td></tr>
        <tr><td>Very Aggressive</td><td>50.7%</td><td>44.6%</td><td>4.7%</td></tr>
        <tr><td>Aggressive</td><td>47.2%</td><td>47.8%</td><td>5.1%</td></tr>
        <tr><td>Balanced</td><td>46.0%</td><td>49.6%</td><td>4.4%</td></tr>
      </table>
    </div>
  </div>

  <div class="finding reveal">
    <div class="finding-title">Surprising Find</div>
    <div class="finding-text">
      In <strong>Aggressive and Balanced openings, Black actually wins more than White</strong> flipping the usual board advantage. This suggests that when White plays aggressively without sufficient preparation, it can backfire, giving Black the initiative through counterplay.
    </div>
  </div>
</section>

<!-- ===== CH 3: DECISIVENESS ===== -->
<section class="chapter">
  <div class="chapter-intro reveal">
    <div>
      <div class="chapter-num">III</div>
    </div>
    <div>
      <div class="chapter-label">Chapter Three</div>
      <h2 class="chapter-title">How Games End: The Decisiveness Story</h2>
      <p class="chapter-body">
        Win rates tell us <em>who</em> wins, but not <em>how</em>. We measured "decisiveness": a score from 0 (draw) to 3 (checkmate) and mapped it across opening styles. Do aggressive openings at least lead to more dramatic conclusions?
      </p>
    </div>
  </div>

  <div class="two-col reveal">
    <div class="chart-container">
      <div class="chart-title">Average Decisiveness Score by Opening Style</div>
      <div class="chart-subtitle">3 = Checkmate, 2 = Resign, 1 = Time, 0 = Draw</div>
      <canvas id="decisiveness" height="200"></canvas>
    </div>
    <div class="chart-container">
      <div class="chart-title">Victory Type Distribution by Opening Style</div>
      <div class="chart-subtitle">How do games actually end?</div>
      <canvas id="victoryTypes" height="200"></canvas>
    </div>
  </div>

  <div class="finding reveal">
    <div class="finding-title">Surprising Finding</div>
    <div class="finding-text">
      <strong>Balanced openings lead to the most decisive games</strong> (avg score: 2.20), edging out Very Aggressive (2.14) and Positional (2.14). This is counterintuitive, "balanced" doesn't mean boring. The most decisive games are often those where neither player commits early, building tension until the position explodes. Aggressive play is dramatic, but balanced play can be equally lethal.
    </div>
  </div>

  <div class="two-col reveal">
    <div class="annotation">
      <div class="icon">‚ôü</div>
      <div class="annotation-text"><strong>Resignation</strong> is the most common ending across all styles, players know when they're beat before the final checkmate arrives.</div>
    </div>
    <div class="annotation">
      <div class="icon">‚è∞</div>
      <div class="annotation-text"><strong>Time losses</strong> are significant; chess clocks are a weapon of their own, independent of opening style.</div>
    </div>
  </div>
</section>

<!-- ===== CH 4: GAME LENGTH ===== -->
<section class="chapter">
  <div class="chapter-intro reveal">
    <div>
      <div class="chapter-num">IV</div>
    </div>
    <div>
      <div class="chapter-label">Chapter Four</div>
      <h2 class="chapter-title">The Long Game vs. The Short Game</h2>
      <p class="chapter-body">
        Conventional wisdom says aggressive games burn fast ,wild attacks either succeed quickly or collapse. Positional games, we imagine, stretch on for hours. What does the data actually say about game length?
      </p>
    </div>
  </div>

  <div class="chart-container reveal">
    <div class="chart-title">Average Game Length (Turns) by Opening Style</div>
    <div class="chart-subtitle">Does aggression really shorten games?</div>
    <canvas id="gameLengthBar" height="100"></canvas>
  </div>

  <div class="stat-row reveal">
    <div class="stat-pill"><div class="val">61.5</div><div class="desc">Positional Avg Turns</div></div>
    <div class="stat-pill"><div class="val">60.6</div><div class="desc">Aggressive Avg Turns</div></div>
    <div class="stat-pill"><div class="val">60.4</div><div class="desc">Very Aggressive Avg Turns</div></div>
    <div class="stat-pill"><div class="val">56.8</div><div class="desc">Balanced Avg Turns</div></div>
  </div>

  <div class="finding reveal">
    <div class="finding-title">Key Finding</div>
    <div class="finding-text">
      Contrary to expectations, game length barely differs by opening style. <strong>Positional games average only 1.1 turns longer than Very Aggressive ones</strong>. Balanced openings actually end fastest. The idea that gambits and attacks lead to quick, decisive battles is largely a myth, aggressive games still grind on to similar length as positional ones.
    </div>
  </div>
</section>

<!-- ===== SECTION BREAK ===== -->
<div class="section-break">
  <div class="big-quote">"The Crossover Point: When does patient play overtake aggression?"</div>
</div>

<!-- ===== CH 5: SKILL LEVEL ===== -->
<section class="chapter">
  <div class="chapter-intro reveal">
    <div>
      <div class="chapter-num">V</div>
    </div>
    <div>
      <div class="chapter-label">Chapter Five</div>
      <h2 class="chapter-title">The Crossover: When Rating Changes Everything</h2>
      <p class="chapter-body">
        Here's where the story gets <em>fascinating</em>. Opening style doesn't have a uniform effect across skill levels. At lower ratings, aggression can be a weapon. At higher ratings, it becomes a liability. The data reveals a dramatic crossover point around <em>rating 1,650</em>.
      </p>
    </div>
  </div>

  <div class="chart-container reveal">
    <div class="chart-title">Aggressive vs. Positional Win Rate Across Skill Levels</div>
    <div class="chart-subtitle">The crossover: where positional chess overtakes aggressive play</div>
    <canvas id="crossoverChart" height="130"></canvas>
  </div>

  <div class="two-col reveal">
    <div class="finding">
      <div class="finding-title">Below 1,650 Rating</div>
      <div class="finding-text">
        <strong>Aggression wins.</strong> At beginner levels, opponents don't know how to punish gambits or handle tactical chaos. A sacrificed pawn for a wild attack often works because the defender makes mistakes. The aggressive player is fishing for blunders and finding them.
      </div>
    </div>
    <div class="finding">
      <div class="finding-title">Above 1,650 Rating</div>
      <div class="finding-text">
        <strong>Positional play takes over.</strong> Stronger players accept gambits correctly, neutralize attacks, and convert the material advantage. At expert levels (2000+), positional win rates climb to 51.6% while aggressive styles fall back. Chaos becomes less useful when your opponent can't be chaosed.
      </div>
    </div>
  </div>

  <div class="chart-container reveal">
    <div class="chart-title">Win Rates by Skill Level : All Styles</div>
    <div class="chart-subtitle">How does opening choice interact with player strength?</div>
    <canvas id="skillLevelChart" height="140"></canvas>
  </div>

  <div class="finding reveal">
    <div class="finding-title">The Beginner Trap</div>
    <div class="finding-text">
      There's a dangerous illusion at work: aggressive play often <em>feels</em> like it's working at lower levels because it frequently does. This creates players who build their identity around sharp, attacking chess only to find that as they improve, their trusted weapons become less effective. The data unmasks this "beginner trap" clearly.
    </div>
  </div>
</section>

<!-- ===== CH 6: THE SHOCKING TRUTH ===== -->
<section class="chapter">
  <div class="chapter-intro reveal">
    <div>
      <div class="chapter-num">VI</div>
    </div>
    <div>
      <div class="chapter-label">Chapter Six : The Shocking Truth</div>
      <h2 class="chapter-title">Skill Dwarfs Style. Completely.</h2>
      <p class="chapter-body">
        After chapters of debating opening aggression, the data delivers its most humbling verdict. The entire effect of opening style on win rate? <em>A 5.6% spread.</em> The effect of being 400 rating points stronger? <em>An 80% swing.</em> This changes everything.
      </p>
    </div>
  </div>

  <div class="chart-container reveal">
    <div class="chart-title">Opening Style Effect vs. Rating Difference Effect</div>
    <div class="chart-subtitle">Side by side: style influence is tiny; skill gap is enormous</div>
    <canvas id="shockingTruth" height="130"></canvas>
  </div>

  <div class="stat-row reveal">
    <div class="stat-pill"><div class="val">5.6%</div><div class="desc">Max Style Effect</div></div>
    <div class="stat-pill"><div class="val">~80%</div><div class="desc">Rating Gap Effect</div></div>
    <div class="stat-pill"><div class="val">14x</div><div class="desc">Skill vs. Style Ratio</div></div>
  </div>

  <div class="finding reveal">
    <div class="finding-title">The Most Important Finding</div>
    <div class="finding-text">
      When White is rated 400+ points higher than Black, White wins approximately <strong>85% of games</strong>. When Black is rated 400+ points higher, Black wins ~85%. Opening style barely registers. <strong>You can play gambits against Magnus Carlsen,  you're still losing.</strong> The brutal mathematical truth: skill is the dominant variable, not style.
    </div>
  </div>

  <!-- Rating gap bar chart as visual progress bars -->
  <div class="chart-container reveal">
    <div class="chart-title">White Win Rate by Rating Advantage</div>
    <div class="chart-subtitle">The most powerful predictor of game outcome</div>
    
    <div class="progress-bar-container">
      <div class="progress-label"><span>White 400+ ahead <span class="tag red">White dominant</span></span><span class="pval">~85%</span></div>
      <div class="progress-track"><div class="progress-fill" data-width="85"></div></div>
    </div>
    <div class="progress-bar-container">
      <div class="progress-label"><span>White 200‚Äì400 ahead</span><span class="pval">~70%</span></div>
      <div class="progress-track"><div class="progress-fill" data-width="70"></div></div>
    </div>
    <div class="progress-bar-container">
      <div class="progress-label"><span>Roughly even (¬±200)</span><span class="pval">~50%</span></div>
      <div class="progress-track"><div class="progress-fill" data-width="50"></div></div>
    </div>
    <div class="progress-bar-container">
      <div class="progress-label"><span>Black 200‚Äì400 ahead</span><span class="pval">~30%</span></div>
      <div class="progress-track"><div class="progress-fill" data-width="30"></div></div>
    </div>
    <div class="progress-bar-container">
      <div class="progress-label"><span>Black 400+ ahead <span class="tag teal">Black dominant</span></span><span class="pval">~15%</span></div>
      <div class="progress-track"><div class="progress-fill" data-width="15"></div></div>
    </div>
  </div>
</section>

<!-- ===== CH 7: RISK vs REWARD ===== -->
<section class="chapter">
  <div class="chapter-intro reveal">
    <div>
      <div class="chapter-num">VII</div>
    </div>
    <div>
      <div class="chapter-label">Chapter Seven</div>
      <h2 class="chapter-title">Risk vs. Reward : The Variance Story</h2>
      <p class="chapter-body">
        Even if aggressive play doesn't win more on average, does it create more variance? Does it increase your chances of beating a stronger player by injecting chaos into the position? The data explores the risk-reward landscape of each style.
      </p>
    </div>
  </div>

  <div class="chart-container reveal">
    <div class="chart-title">Win Rate Variance by Opening Style & Skill Level</div>
    <div class="chart-subtitle">Higher variance = more unpredictable outcomes (bubble size = decisiveness score)</div>
    <canvas id="riskReward" height="200"></canvas>
  </div>

  <div class="two-col reveal">
    <div class="annotation">
      <div class="icon">üé≤</div>
      <div class="annotation-text"><strong>Aggressive styles show slightly higher variance</strong>, they're the gambler's choice. You might win when you shouldn't, or lose when you shouldn't. More chaotic outcomes.</div>
    </div>
    <div class="annotation">
      <div class="icon">üèõÔ∏è</div>
      <div class="annotation-text"><strong>Positional styles are steadier</strong> the result more reliably follows the skill gap. If you're better, you'll convert. If you're worse, you'll lose. Less luck, more justice.</div>
    </div>
  </div>

  <div class="finding reveal">
    <div class="finding-title">Strategic Implication</div>
    <div class="finding-text">
      This has practical advice buried in it: <strong>if you're the underdog, aggression is actually your best statistical hope</strong> it introduces variance that can give you a puncher's chance. If you're the favorite, play solid positional chess, it reduces the chance of an upset. The data validates what chess coaches have long known intuitively.
    </div>
  </div>
</section>

<!-- ===== CONCLUSION ===== -->
<section class="conclusion">
  <div class="chapter-label" style="margin-bottom:20px;">The Verdict</div>
  <h2 class="chapter-title" style="font-family:'Cinzel Decorative',serif; font-size:clamp(22px,4vw,46px); text-align:center; background:linear-gradient(135deg,var(--gold-light),var(--gold)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;">Checkmate, Opening Style.</h2>

  <div class="verdict-box reveal">
    <canvas id="verdictConfetti"></canvas>
    <div class="verdict-panel">
      <div class="verdict-badge">
        <div class="badge-icon">‚ôõ</div>
        <div class="badge-text">Final Verdict</div>
        <div class="badge-sub">Checkmate, Opening Style</div>
      </div>
      <div class="verdict-body">
        <div class="verdict-summary">Does aggression win at chess? <strong>Sort of ‚Äî but only in the right context.</strong> Skill level is the dominant factor; style yields a small edge that flips across ratings.</div>

        <div class="verdict-chips">
          <div class="verdict-chip">Max Style Effect: 5.6%</div>
          <div class="verdict-chip">Rating Gap Effect: ~80%</div>
          <div class="verdict-chip">Skill vs Style: 14x</div>
        </div>

        <div class="verdict-more" id="verdictMore">
          <p class="verdict-text">At <strong>lower skill levels</strong>, aggressive openings provide a genuine statistical edge ‚Äî gambits and sharp attacks exploit common defensive mistakes. As players improve, however, positional play becomes more reliable: experienced opponents neutralize early chaos and convert material or structural advantages.</p>
          <p class="verdict-text">The practical takeaway: if you're an underdog, sharper, aggressive lines can increase variance in your favor. If you're the stronger player, play solid positional chess to reduce upsets. Ultimately, work on fundamentals ‚Äî rating matters far more than opening style.</p>
        </div>

        <button class="verdict-toggle" id="verdictToggle">Read more</button>
      </div>
    </div>
  </div>

  <div class="piece-row" style="opacity:0.6; font-size:36px;">‚ôî ‚ôï ‚ôñ ‚ôó ‚ôò ‚ôô</div>
</section>

<footer>
  <div style="margin-bottom:16px; font-size:22px;">‚ôü ‚ôü ‚ôü</div>
  Dataset: <a href="https://database.lichess.org/" target="_blank" rel="noopener noreferrer" class="gold">Lichess Chess Games</a> ¬∑ 20,058 games ¬∑ Analysis by <span class="gold">Python / Pandas / Matplotlib</span>
  <br><br>
  Submitted for the <span class="gold">Cod√©dex Data Science Monthly Challenge</span> ¬∑ February 2026
  <br><br>
  "Chess is not about the opening. Chess is about the player."
</footer>

</div><!-- /content -->

<script>
// ===== CHESS BOARD BACKGROUND =====
const chessBg = document.getElementById('chessBg');
for (let r = 0; r < 8; r++) {
  for (let c = 0; c < 8; c++) {
    const sq = document.createElement('div');
    sq.className = 'sq ' + ((r + c) % 2 === 0 ? 'light' : 'dark');
    chessBg.appendChild(sq);
  }
}

// ===== CHART DEFAULTS =====
Chart.defaults.color = 'rgba(245,240,232,0.6)';
Chart.defaults.font.family = 'EB Garamond, serif';
Chart.defaults.font.size = 13;

const GOLD = '#D4A843';
const GOLD_LIGHT = '#F0C85A';
const RED = '#C0392B';
const TEAL = '#4ECDC4';
const BLUE = '#3A86FF';
const ORANGE = '#FFA500';
const GRID_COLOR = 'rgba(245,240,232,0.06)';

const gridOpts = {
  color: GRID_COLOR,
  borderColor: 'rgba(245,240,232,0.1)'
};

// ===== 1. OPENING DISTRIBUTION =====
new Chart(document.getElementById('openingDistChart'), {
  type: 'bar',
  data: {
    labels: ['Positional', 'Very Aggressive', 'Aggressive', 'Balanced'],
    datasets: [{
      label: 'Number of Games',
      data: [8836, 5137, 3541, 2544],
      backgroundColor: [TEAL, RED, ORANGE, BLUE],
      borderColor: 'transparent',
      borderRadius: 2,
    }]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { display: false },
      tooltip: {
        callbacks: {
          label: (ctx) => `${ctx.raw.toLocaleString()} games (${(ctx.raw/20058*100).toFixed(1)}%)`
        }
      }
    },
    scales: {
      x: { grid: gridOpts },
      y: { grid: gridOpts, ticks: { callback: v => v.toLocaleString() } }
    }
  }
});

// ===== 2. WIN RATE BY STYLE =====
new Chart(document.getElementById('winRateByStyle'), {
  type: 'bar',
  data: {
    labels: ['Positional', 'Very Agg.', 'Aggressive', 'Balanced'],
    datasets: [
      { label: 'White Wins', data: [51.6, 50.7, 47.2, 46.0], backgroundColor: 'rgba(240,200,90,0.8)', borderRadius: 2 },
      { label: 'Black Wins', data: [43.7, 44.6, 47.8, 49.6], backgroundColor: 'rgba(192,57,43,0.7)', borderRadius: 2 },
      { label: 'Draws', data: [4.7, 4.7, 5.1, 4.4], backgroundColor: 'rgba(78,205,196,0.6)', borderRadius: 2 },
    ]
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top' } },
    scales: {
      x: { stacked: false, grid: gridOpts },
      y: { grid: gridOpts, ticks: { callback: v => v + '%' }, max: 60 }
    }
  }
});

// ===== 3. DECISIVENESS =====
new Chart(document.getElementById('decisiveness'), {
  type: 'bar',
  data: {
    labels: ['Balanced', 'Very Agg.', 'Positional', 'Aggressive'],
    datasets: [{
      label: 'Avg Decisiveness',
      data: [2.197, 2.142, 2.143, 2.095],
      backgroundColor: [BLUE, RED, TEAL, ORANGE],
      borderRadius: 2,
    }]
  },
  options: {
    responsive: true,
    plugins: { legend: { display: false } },
    scales: {
      x: { grid: gridOpts },
      y: { grid: gridOpts, min: 2.05, max: 2.25 }
    }
  }
});

// ===== 4. VICTORY TYPES =====
new Chart(document.getElementById('victoryTypes'), {
  type: 'bar',
  data: {
    labels: ['Positional', 'Very Agg.', 'Aggressive', 'Balanced'],
    datasets: [
      { label: 'Checkmate', data: [23, 22, 20, 24], backgroundColor: 'rgba(192,57,43,0.85)', borderRadius: 1 },
      { label: 'Resign', data: [55, 54, 53, 57], backgroundColor: 'rgba(240,200,90,0.85)', borderRadius: 1 },
      { label: 'Time Out', data: [17, 20, 22, 15], backgroundColor: 'rgba(78,205,196,0.75)', borderRadius: 1 },
      { label: 'Draw', data: [5, 4.7, 5.1, 4.4], backgroundColor: 'rgba(120,120,120,0.6)', borderRadius: 1 },
    ]
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top', labels: { font: { size: 11 } } } },
    scales: {
      x: { stacked: true, grid: gridOpts },
      y: { stacked: true, grid: gridOpts, ticks: { callback: v => v + '%' } }
    }
  }
});

// ===== 5. GAME LENGTH =====
new Chart(document.getElementById('gameLengthBar'), {
  type: 'bar',
  data: {
    labels: ['Positional', 'Aggressive', 'Very Aggressive', 'Balanced'],
    datasets: [{
      label: 'Average Turns',
      data: [61.5, 60.6, 60.4, 56.8],
      backgroundColor: [TEAL, ORANGE, RED, BLUE],
      borderRadius: 2,
    }]
  },
  options: {
    responsive: true,
    plugins: { legend: { display: false } },
    scales: {
      x: { grid: gridOpts },
      y: { grid: gridOpts, min: 50, max: 68, ticks: { callback: v => v + ' turns' } }
    }
  }
});

// ===== 6. CROSSOVER CHART =====
new Chart(document.getElementById('crossoverChart'), {
  type: 'line',
  data: {
    labels: ['Beginner (1100)', 'Intermediate (1500)', 'Advanced (1800)', 'Expert (2200)'],
    datasets: [
      {
        label: 'Aggressive',
        data: [50.0, 50.7, 49.4, 46.6],
        borderColor: RED,
        backgroundColor: 'rgba(192,57,43,0.1)',
        fill: true,
        tension: 0.4,
        pointRadius: 6,
        pointBackgroundColor: RED,
        borderWidth: 3,
      },
      {
        label: 'Positional',
        data: [48.5, 49.8, 51.2, 52.8],
        borderColor: TEAL,
        backgroundColor: 'rgba(78,205,196,0.1)',
        fill: true,
        tension: 0.4,
        pointRadius: 6,
        pointBackgroundColor: TEAL,
        borderWidth: 3,
      },
      {
        label: 'Very Aggressive',
        data: [51.2, 50.9, 49.8, 47.5],
        borderColor: ORANGE,
        backgroundColor: 'rgba(255,165,0,0.05)',
        fill: false,
        tension: 0.4,
        pointRadius: 5,
        pointBackgroundColor: ORANGE,
        borderWidth: 2,
        borderDash: [5,5],
      }
    ]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { position: 'top' },
      annotation: {}
    },
    scales: {
      x: { grid: gridOpts },
      y: { grid: gridOpts, min: 44, max: 56, ticks: { callback: v => v + '%' } }
    }
  }
});

// ===== 7. SKILL LEVEL ALL STYLES =====
new Chart(document.getElementById('skillLevelChart'), {
  type: 'line',
  data: {
    labels: ['Beginner', 'Intermediate', 'Advanced', 'Expert'],
    datasets: [
      { label: 'White Wins', data: [50.0, 50.7, 49.4, 46.6], borderColor: GOLD, backgroundColor: 'rgba(212,168,67,0.08)', fill: true, tension: 0.4, pointRadius: 5, borderWidth: 2.5 },
      { label: 'Black Wins', data: [44.8, 45.4, 45.5, 45.5], borderColor: RED, backgroundColor: 'rgba(192,57,43,0.06)', fill: true, tension: 0.4, pointRadius: 5, borderWidth: 2.5 },
      { label: 'Draws', data: [5.1, 3.9, 5.2, 8.0], borderColor: TEAL, fill: false, tension: 0.4, pointRadius: 5, borderWidth: 2, borderDash: [4,4] },
    ]
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top' } },
    scales: {
      x: { grid: gridOpts },
      y: { grid: gridOpts, ticks: { callback: v => v + '%' } }
    }
  }
});

// ===== 8. SHOCKING TRUTH =====
const shockCtx = document.getElementById('shockingTruth');
new Chart(shockCtx, {
  type: 'bar',
  data: {
    labels: ['Pos.', 'V.Agg.', 'Agg.', 'Bal.', '', 'W+400', 'W+200', 'Even', 'B+200', 'B+400'],
    datasets: [{
      label: 'Win Rate',
      data: [51.6, 50.7, 47.2, 46.0, null, 85, 68, 50, 32, 15],
      backgroundColor: [TEAL, ORANGE, RED, BLUE, 'transparent', '#CC0000', '#FF6655', '#FFAA88', '#4499DD', '#0066CC'],
      borderRadius: 2,
    }]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { display: false },
      tooltip: { callbacks: { label: ctx => ctx.raw + '%' } }
    },
    scales: {
      x: { grid: gridOpts },
      y: { grid: gridOpts, min: 0, max: 100, ticks: { callback: v => v + '%' } }
    }
  }
});

// ===== 9. RISK REWARD =====
new Chart(document.getElementById('riskReward'), {
  type: 'bubble',
  data: {
    datasets: [
      {
        label: 'Very Aggressive',
        data: [
          { x: 0.507, y: 0.28, r: 14 },
          { x: 0.509, y: 0.32, r: 12 },
          { x: 0.503, y: 0.25, r: 10 },
          { x: 0.512, y: 0.30, r: 13 },
        ],
        backgroundColor: 'rgba(192,57,43,0.5)',
        borderColor: RED,
      },
      {
        label: 'Aggressive',
        data: [
          { x: 0.472, y: 0.27, r: 13 },
          { x: 0.481, y: 0.24, r: 11 },
          { x: 0.468, y: 0.30, r: 12 },
          { x: 0.476, y: 0.26, r: 10 },
        ],
        backgroundColor: 'rgba(255,165,0,0.5)',
        borderColor: ORANGE,
      },
      {
        label: 'Positional',
        data: [
          { x: 0.516, y: 0.22, r: 14 },
          { x: 0.511, y: 0.20, r: 13 },
          { x: 0.521, y: 0.24, r: 12 },
          { x: 0.508, y: 0.21, r: 11 },
        ],
        backgroundColor: 'rgba(78,205,196,0.5)',
        borderColor: TEAL,
      },
      {
        label: 'Balanced',
        data: [
          { x: 0.460, y: 0.20, r: 14 },
          { x: 0.455, y: 0.23, r: 12 },
          { x: 0.465, y: 0.19, r: 11 },
        ],
        backgroundColor: 'rgba(58,134,255,0.5)',
        borderColor: BLUE,
      },
    ]
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top' } },
    scales: {
      x: { grid: gridOpts, title: { display: true, text: 'Mean Win Rate (Reward)', color: 'rgba(245,240,232,0.5)' }, min: 0.44, max: 0.54, ticks: { callback: v => (v*100).toFixed(0) + '%' } },
      y: { grid: gridOpts, title: { display: true, text: 'Win Rate Std Dev (Risk)', color: 'rgba(245,240,232,0.5)' }, min: 0.15, max: 0.38 }
    }
  }
});

// ===== REVEAL ON SCROLL =====
const reveals = document.querySelectorAll('.reveal');
const observer = new IntersectionObserver((entries) => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      e.target.classList.add('visible');
      // Animate progress bars
      e.target.querySelectorAll('.progress-fill').forEach(bar => {
        setTimeout(() => { bar.style.width = bar.dataset.width + '%'; }, 100);
      });
    }
  });
}, { threshold: 0.15 });

reveals.forEach(el => observer.observe(el));

// Also animate any progress bars already visible
document.querySelectorAll('.progress-fill').forEach(bar => {
  const parentReveal = bar.closest('.reveal');
  if (!parentReveal) {
    setTimeout(() => { bar.style.width = bar.dataset.width + '%'; }, 500);
  }
});

// ===== SECTION COUNTER (updates on scroll) =====
const sectionCounter = document.getElementById('sectionCounter');
if (sectionCounter) {
  const chapters = document.querySelectorAll('.chapter');
  const secObserver = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        const numEl = e.target.querySelector('.chapter-num');
        const label = numEl ? numEl.textContent.trim() : '';
        sectionCounter.textContent = label;
        sectionCounter.classList.add('visible');
        if (sectionCounter._hideTimeout) clearTimeout(sectionCounter._hideTimeout);
        sectionCounter._hideTimeout = setTimeout(() => sectionCounter.classList.remove('visible'), 1200);
      }
    });
  }, { threshold: 0.45 });
  chapters.forEach(c => secObserver.observe(c));
}

// make the section counter clickable: scroll to the last observed chapter
if (sectionCounter) {
  sectionCounter._lastChapter = null;
  // track last visible chapter from secObserver via a small bridge
  const bridgeObserver = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        sectionCounter._lastChapter = e.target;
      }
    });
  }, { threshold: 0.45 });
  document.querySelectorAll('.chapter').forEach(c => bridgeObserver.observe(c));

  // previous click handler removed; navigation dropdown will handle clicks instead
  sectionCounter.addEventListener('click', (ev) => { ev.preventDefault(); });
}

// Enhance the sectionCounter label to include chapter title when observed
// (patching secObserver handler to include title)
// Update: find existing secObserver by re-running small observer to overwrite label behavior
{
  const chapters = document.querySelectorAll('.chapter');
  const labelObserver = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        const numEl = e.target.querySelector('.chapter-num');
        const titleEl = e.target.querySelector('.chapter-title') || e.target.querySelector('.chapter-label');
        const label = numEl ? numEl.textContent.trim() : '';
        const title = titleEl ? titleEl.textContent.trim() : '';
        sectionCounter.textContent = title ? `${label} ‚Äî ${title}` : label;
        sectionCounter.classList.add('visible');
        if (sectionCounter._hideTimeout) clearTimeout(sectionCounter._hideTimeout);
        sectionCounter._hideTimeout = setTimeout(() => sectionCounter.classList.remove('visible'), 1600);
      }
    });
  }, { threshold: 0.45 });
  chapters.forEach(c => labelObserver.observe(c));
}

// Slightly increase floating pieces visibility when hovering the page
document.addEventListener('mousemove', () => {
  const fp = document.querySelector('.floating-pieces');
  if (!fp) return;
  fp.style.opacity = '0.18';
  clearTimeout(fp._t);
  fp._t = setTimeout(() => { fp.style.opacity = '0.12'; }, 800);
});

// ===== VERDICT TOGGLE + CONFETTI =====
const verdictToggle = document.getElementById('verdictToggle');
const verdictMore = document.getElementById('verdictMore');
if (verdictToggle && verdictMore) {
  verdictToggle.addEventListener('click', () => {
    const open = verdictMore.classList.toggle('open');
    verdictToggle.textContent = open ? 'Show less' : 'Read more';
  });
}

// simple confetti inside verdict box when it becomes visible
const confettiCanvas = document.getElementById('verdictConfetti');
if (confettiCanvas) {
  const ctx = confettiCanvas.getContext('2d');
  let confetti = [];
  function resizeCanvas() { confettiCanvas.width = confettiCanvas.offsetWidth; confettiCanvas.height = confettiCanvas.offsetHeight; }
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();

  function spawnConfetti() {
    confetti = [];
    for (let i=0;i<28;i++) {
      confetti.push({ x: Math.random()*confettiCanvas.width, y: Math.random()*-confettiCanvas.height, r: 6+Math.random()*8, vx:(Math.random()-0.5)*1.2, vy:2+Math.random()*3, c: ['#F0C85A','#D4A843','#C0392B','#4ECDC4'][Math.floor(Math.random()*4)] });
    }
    requestAnimationFrame(step);
  }
  function step() {
    ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
    confetti.forEach(p => {
      p.x += p.vx; p.y += p.vy; p.vy += 0.03;
      ctx.fillStyle = p.c; ctx.beginPath(); ctx.ellipse(p.x,p.y,p.r*0.6,p.r,0,0,Math.PI*2); ctx.fill();
    });
    confetti = confetti.filter(p => p.y < confettiCanvas.height+50);
    if (confetti.length) requestAnimationFrame(step);
  }

  // trigger confetti when verdict-box becomes visible
  const vb = document.querySelector('.verdict-box.reveal');
  if (vb) {
    const vbObserver = new IntersectionObserver((entries) => {
      entries.forEach(e => { if (e.isIntersecting) { spawnConfetti(); vbObserver.disconnect(); } });
    }, { threshold: 0.35 });
    vbObserver.observe(vb);
  }
}

// ===== HIGHLIGHT NUMBERS =====
function highlightNumbers(root) {
  const skipTags = new Set(['SCRIPT','STYLE','A','CANVAS','SVG','BUTTON','INPUT','TEXTAREA','SELECT']);
  const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, null, false);
  const re = /(?<!\S)([0-9]{1,3}(?:[,\.][0-9]{3})*(?:\.[0-9]+)?%?)(?!\S)/g;
  const toWrap = [];
  while(walker.nextNode()) {
    const node = walker.currentNode;
    const parent = node.parentElement;
    if (!node.nodeValue || !parent) continue;
    if (skipTags.has(parent.tagName)) continue;
    if (parent.classList && (parent.classList.contains('num') || parent.classList.contains('num-highlight') || parent.classList.contains('chapter-num') )) continue;
    if (!re.test(node.nodeValue)) continue;
    toWrap.push(node);
  }
  toWrap.forEach(textNode => {
    const span = document.createElement('span');
    const html = textNode.nodeValue.replace(/(?<!\S)([0-9]{1,3}(?:[,\.][0-9]{3})*(?:\.[0-9]+)?%?)(?!\S)/g, '<span class="num-highlight">$1</span>');
    span.innerHTML = html;
    textNode.parentNode.replaceChild(span, textNode);
  });
}
try { highlightNumbers(document.querySelector('.content')); } catch(e){ /* fail silently */ }

// ===== CHAPTER NAVIGATOR BUILD =====
const chapterNav = document.getElementById('chapterNav');
if (chapterNav) {
  const chapterEls = Array.from(document.querySelectorAll('.chapter'));
  chapterNav.innerHTML = chapterEls.map((c, idx) => {
    const numEl = c.querySelector('.chapter-num');
    const titleEl = c.querySelector('.chapter-title') || c.querySelector('.chapter-label');
    const num = numEl ? numEl.textContent.trim() : (idx+1);
    const title = titleEl ? titleEl.textContent.trim() : `Chapter ${idx+1}`;
    return `<button data-idx="${idx}" aria-label="Go to ${title}"><span class="chap-num">${num}</span><span class="chap-title">${title}</span></button>`;
  }).join('');

  chapterNav.addEventListener('click', (ev) => {
    const btn = ev.target.closest('button[data-idx]');
    if (!btn) return;
    const idx = Number(btn.getAttribute('data-idx'));
    const target = chapterEls[idx];
    if (target) {
      chapterNav.classList.remove('visible');
      chapterNav.setAttribute('aria-hidden','true');
      target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });

  // toggle nav when clicking the section counter
  sectionCounter.addEventListener('click', (ev) => {
    ev.stopPropagation();
    const isVisible = chapterNav.classList.toggle('visible');
    chapterNav.setAttribute('aria-hidden', (!isVisible).toString());
  });

  // close nav on outside click or escape
  document.addEventListener('click', (e) => {
    if (!chapterNav.contains(e.target) && e.target !== sectionCounter) {
      chapterNav.classList.remove('visible');
      chapterNav.setAttribute('aria-hidden', 'true');
    }
  });
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { chapterNav.classList.remove('visible'); chapterNav.setAttribute('aria-hidden','true'); } });
}
</script>
</body>
</html>
